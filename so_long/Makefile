# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: abeaufil <abeaufil@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/02/03 11:44:30 by abeaufil          #+#    #+#              #
#    Updated: 2025/02/28 10:42:34 by abeaufil         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

RED     = \033[31m
GREEN   = \033[32m
YELLOW  = \033[33m
BLUE    = \033[34m
CYAN    = \033[36m
RESET   = \033[0m

NAME	= so_long
CC		= cc
CFLAGS	= -Wall -Werror -Wextra -I./minilibx-linux -c -ggdb -gdwarf-3

SRC_PATH = sources/
OBJ_PATH = objet/

SRC		= \
			so_long.c parsing.c \

SRCS	= $(addprefix $(SRC_PATH), $(SRC))
OBJ		= $(SRC:.c=.o)
OBJS	= $(addprefix $(OBJ_PATH), $(OBJ))
HEAD	= -I ./header/

LIBFT_DIR = ./sources/ultimate_libft
LIBFT_INCLUDE = -I$(LIBFT_DIR)/includes
LIBFT_LIB = $(LIBFT_DIR)/libft.a

MLX_DIR = ./minilibx-linux
MLX_LIB = $(MLX_DIR)/libmlx.a

all: $(OBJ_PATH) $(NAME)

$(OBJ_PATH)%.o: $(SRC_PATH)%.c
	@$(CC) $(CFLAGS) -c $< -o $@ $(HEAD) $(LIBFT_INCLUDE)
	@echo "$(CYAN)üîß Compilation de $(notdir $<)$(RESET)"

$(OBJ_PATH):
	@mkdir -p $(OBJ_PATH)
	@echo "$(YELLOW)üìÅ Dossier $(OBJ_PATH) cr√©√©$(RESET)"

$(LIBFT_LIB):
	@$(MAKE) -C $(LIBFT_DIR) > /dev/null 2>&1
	@echo "$(GREEN)‚úÖ libft_ultimate compil√©e avec succ√®s !$(RESET)"

$(MLX_LIB):
	@$(MAKE) -C $(MLX_DIR) > /dev/null 2>&1
	@echo "$(GREEN)‚úÖ MiniLibX compil√©e avec succ√®s !$(RESET)"

$(NAME): $(OBJS) $(LIBFT_LIB) $(MLX_LIB)
	@$(CC) $(OBJS) $(LIBFT_LIB) $(MLX_LIB) -lX11 -lXext -o $(NAME)
	@echo "$(GREEN)‚úÖ $(NAME) cr√©√© avec succ√®s !$(RESET)"

clean:
	@rm -rf $(OBJ_PATH)
	@echo "$(YELLOW)üßπ Suppression des objets$(RESET)"

fclean: clean
	@rm -f $(NAME)
	@$(MAKE) fclean -C $(LIBFT_DIR) > /dev/null 2>&1
	@$(MAKE) clean -C $(MLX_DIR) > /dev/null 2>&1
	@echo "$(RED)üóëÔ∏è  Suppression compl√®te$(RESET)"

re: fclean all

.PHONY: all clean fclean re
